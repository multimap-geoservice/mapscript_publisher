{
    "IMODS":["interface"],
    "VARS":{
        "name": "osm-spb",
        "wms_title": "Open Street Map S.Peterburg",
        "up_scale": 332808204,
        "imagecolor": [153, 179, 204], 
        "extent": [
            3276111.5,
            8318651.22,
            3424131.14,
            8454451.02
        ],
        "size": [800, 800],
        "wms_srs": {
            "RUN":{
                "interface.proj2str": [
                    3857,
                    4326,
                    32638,
                    2154,
                    310642901,
                    4171,
                    310024802,
                    310915814,
                    310486805,
                    310702807,
                    310700806,
                    310547809,
                    310706808,
                    310642810,
                    310642801,
                    310642812,
                    310032811,
                    310642813,
                    2986
                ]
                
            }
        },
        "db_connection": "",
        "epsg_id": 3857,
        "label_polygon": {
            "OBJ": "mapscript.labelObj",
            "font": "sc",
            "encoding": "utf-8",
            "partials": {"OBJ": "mapscript.MS_FALSE"},
            "minfeaturesize":1,
            "size":8,
            "color":{
                "TEMP": "{{ macros.color_rgb(0,0,0) }}"
            },
            "outlinecolor":{
                "TEMP": "{{ macros.color_rgb(255,255,255) }}"
            },
            "outlinewidth":2,
            "wrap": " ",
            "maxlength":6,
            "align":{"OBJ": "mapscript.MS_ALIGN_CENTER"}
        },
        "label_line": {
            "OBJ": "mapscript.labelObj",
            "font": "sc",
            "encoding": "utf-8",
            "minfeaturesize":1,
            "mindistance": 200,
            "size":8,
            "color":{
                "TEMP": "{{ macros.color_rgb(0,0,0) }}"
            },
            "outlinecolor":{
                "TEMP": "{{ macros.color_rgb(255,255,255) }}"
            },
            "outlinewidth":2,
            "repeatdistance": 400,
            "anglemode":{"OBJ": "mapscript.MS_FOLLOW"},
            "position": {"OBJ": "mapscript.MS_AUTO"},
            "priority": 2
        },
        "end_query_str": "as foo using unique osm_id using srid={}",
        "layer_dicts": [
            {
                "layer_temp": "transport_areas",
                "name": "transport_areas",
                "wms_abstract": "transport areas",
                "data": {
                    "RUN":{
                        "interface.lst2str":[
                            "geometry from",
                            "(",
                            "select way as geometry,",
                            "osm_id,",
                            "name as name",
                            "from planet_osm_polygon",
                            "where railway = 'station'",
                            "or aeroway in",
                            "(",
                            "    'aerodrome',",
                            "    'terminal',",
                            "    'helipad',",
                            "    'apron'",
                            ")",
                            "order by area desc",
                            ")",
                            {
                                "VAR": "end_query_str",
                                "{}": {
                                    "VAR":"epsg_id"
                                }
                            }
                        ]
                    }
                }
            }, 
            {
                "layer_temp": "landuse",
                "name": "landuse",
                "wms_abstract": "landuse",
                "data": {
                    "RUN":{
                        "interface.lst2str":[
                            "geometry from",
                            "(",
                            "select way as geometry,",
                            "osm_id,",
                            "concat(",
                            "    landuse,",
                            "    \"natural\",",
                            "    leisure,",
                            "    highway,",
                            "    amenity",
                            ") as type,",
                            "name as name",
                            "from planet_osm_polygon",
                            "where landuse in",
                            "(",
                            "    'forest',",
                            "    'cemetery',",
                            "    'industrial',",
                            "    'commercial',",
                            "    'brownfield',",
                            "    'residential',",
                            "    'military'",
                            ")",
                            "or leisure in",
                            "(",
                            "    'park',",
                            "    'golf_course',",
                            "    'stadium',",
                            "    'sports_center',",
                            "    'pitch'",
                            ")",
                            "or amenity in",
                            "(",
                            "    'hospital',",
                            "    'school',",
                            "    'college',",
                            "    'university',",
                            "    'parking'",
                            ")",
                            "or \"natural\" = 'wood'",
                            "or highway = 'pedestrian'",
                            "order by area desc",
                            ")",
                            {
                                "VAR": "end_query_str",
                                "{}": {
                                    "VAR":"epsg_id"
                                }
                            }
                        ]
                    }
                }
            }, 
            {
                "layer_temp": "waterareas",
                "name": "waterareas",
                "wms_abstract": "waterareas",
                "data": {
                    "RUN":{
                        "interface.lst2str":[
                            "geometry from",
                            "(",
                            "select way as geometry,",
                            "osm_id,",
                            "concat(",
                            "    landuse,",
                            "    \"natural\",",
                            "    waterway",
                            ") as type,",
                            "name as name",
                            "from planet_osm_polygon",
                            "where landuse in",
                            "(",
                            "    'basin',",
                            "    'reservoir'",
                            ")",
                            "or \"natural\" = 'water'",
                            "or waterway = 'riverbank'",
                            "order by area desc",
                            ")",
                            {
                                "VAR": "end_query_str",
                                "{}": {
                                    "VAR":"epsg_id"
                                }
                            }
                        ]
                    }
                }
            }, 
            {
                "layer_temp": "waterways",
                "name": "waterways",
                "wms_abstract": "waterways",
                "data": {
                    "RUN":{
                        "interface.lst2str":[
                            "geometry from",
                            "(",
                            "select way as geometry,",
                            "osm_id,",
                            "waterway as type,",
                            "name as name",
                            "from planet_osm_line",
                            "where waterway in",
                            "(",
                            "    'stream',",
                            "    'river',",
                            "    'canal',",
                            "    'drain'",
                            ")",
                            "order by area desc",
                            ")",
                            {
                                "VAR": "end_query_str",
                                "{}": {
                                    "VAR":"epsg_id"
                                }
                            }
                        ]
                    }
                }
            }, 
            {
                "layer_temp": "railways",
                "name": "railways",
                "wms_abstract": "railways",
                "data": {
                    "RUN":{
                        "interface.lst2str":[
                            "geometry from",
                            "(",
                            "select way as geometry,",
                            "osm_id,",
                            "railway as type,",
                            "name as name",
                            "from planet_osm_line",
                            "where railway in",
                            "(",
                            "    'rail',",
                            "    'light_rail',",
                            "    'subway',",
                            "    'narrow_gauge',",
                            "    'preserved',",
                            "    'funicular',",
                            "    'monorail'",
                            ")",
                            "order by area desc",
                            ")",
                            {
                                "VAR": "end_query_str",
                                "{}": {
                                    "VAR":"epsg_id"
                                }
                            }
                        ]
                    }
                }
            }, 
            {
                "layer_temp": "buildings",
                "name": "buildings",
                "wms_abstract": "buildings",
                "data": {
                    "RUN":{
                        "interface.lst2str":[
                            "geometry from",
                            "(",
                            "select way as geometry,",
                            "osm_id,",
                            "name as name",
                            "from planet_osm_polygon",
                            "where building is not null",
                            ")",
                            {
                                "VAR": "end_query_str",
                                "{}": {
                                    "VAR":"epsg_id"
                                }
                            }
                        ]
                    }
                }
            } 
        ]
    },
    "TEMPS":{
        "macros":[
            { "TEMP": "{% macro color_rgb(r, g, b) -%}"},
            {
                "SUB_OBJ":{
                    "OBJ": "mapscript.colorObj",
                    "OBJ_ARG": [
                        {"TEMP": "{{r}}"},
                        {"TEMP": "{{g}}"},
                        {"TEMP": "{{b}}"}
                    ]
                }
            },
            { "TEMP": "{%- endmacro -%}"},
            { "TEMP": "{% macro color_hex(hex) -%}"},
            {
                "SUB_OBJ":{
                    "OBJ": "mapscript.colorObj",
                    "setHex": {"TEMP": "\"{{hex}}\""}
                }
            },
            { "TEMP": "{%- endmacro -%}"}
        ],
        "landuse":[
            { "TEMP": "{% import 'macros' as macros %}"},
            {    
                "4-20":{
                    "OBJ": "mapscript.layerObj",
                    "name": {"TEMP": "\"{{layer_var['name']}}\""},
                    "group": {"TEMP": "\"{{layer_var['name']}}\""},
                    "status": {"OBJ": "mapscript.MS_ON"}, 
                    "setProjection": {"TEMP":"\"init=epsg:{{epsg_id}}\""},
                    "type": {"OBJ": "mapscript.MS_LAYER_POLYGON"}, 
                    "units": {"OBJ": "mapscript.MS_METERS"},
                    "tileitem": "location",
                    "connectiontype": {"OBJ": "mapscript.MS_POSTGIS"},
                    "connection": {"VAR": "db_connection"},
                    "data": {"TEMP": "\"{{layer_var['data']}}\""},
                    "setProcessing":[
                            "LABEL_NO_CLIP=ON", 
                            "CLOSE_CONNECTION=DEFER"
                        ], 
                    "metadata.set": [
                        [
                            "wms_abstract",
                            {"TEMP": "\"{{layer_var['wms_abstract']}}\""}
                        ]
                    ],
                    "classitem": "type",
                    "labelitem": "name",
                    "SUB_OBJ":[
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["{forest,wood}"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(203,216,195) }}"
                                    }
                                }
                            ],
                            "addLabel": {
                                "12-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_polygon"
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["residential"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(242,239,233) }}"
                                    },
                                    "outlinecolor": {
                                        "TEMP": "{{ macros.color_hex('#e3ded4') }}"
                                    },
                                    "outlinewidth": 0
                                }
                            ],
                            "addLabel": {
                                "12-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_polygon"
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["{industrial,commercial,parking}"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(209,208,205) }}"
                                    },
                                    "outlinecolor": {
                                        "TEMP": "{{ macros.color_hex('#d1d1d1') }}"
                                    },
                                    "outlinewidth": 0
                                }
                            ],
                            "addLabel": {
                                "11-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_polygon",
                                        "priority": 2
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["{park,golf_course}"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(181,210,156) }}"
                                    }
                                }
                            ],
                            "addLabel": {
                                "11-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_polygon",
                                        "priority": 2,
                                        "position": {"OBJ": "mapscript.MS_CC"}
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["cemetery"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_hex('#d1d1d1') }}"
                                    }
                                }
                            ],
                            "addLabel": {
                                "12-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_polygon",
                                        "priority": 2,
                                        "position": {"OBJ": "mapscript.MS_CC"}
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["pedestrian"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(250,250,245) }}"
                                    }
                                }
                            ],
                            "addLabel": {
                                "12-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_polygon",
                                        "size":0,
                                        "color":{
                                            "TEMP": "{{ macros.color_hex('#333333') }}"
                                        },
                                        "-": "align"
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["hospital"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(229,198,195) }}"
                                    }
                                }
                            ],
                            "addLabel": {
                                "12-20": {
                                    "SUB_OBJ":{
                                        "VAR": "label_polygon",
                                        "priority": 1
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["{school,college,university}"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(222,210,172) }}"
                                    }
                                }
                            ],
                            "addLabel": {
                                "12-20": {
                                    "SUB_OBJ":{
                                        "VAR": "label_polygon",
                                        "priority": 1
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["{sports_center,stadium,pitch}"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_hex('#ded1ab') }}"
                                    }
                                }
                            ],
                            "addLabel": {
                                "12-20": {
                                    "SUB_OBJ":{
                                        "VAR": "label_polygon",
                                        "priority": 1
                                    }
                                }
                            }
                        }
                    ]
                }
            }
        ],
        "transport_areas":[
            { "TEMP": "{% import 'macros' as macros %}"},
            {    
                "11-20":{
                    "OBJ": "mapscript.layerObj",
                    "name": {"TEMP": "\"{{layer_var['name']}}\""},
                    "group": {"TEMP": "\"{{layer_var['name']}}\""},
                    "status": {"OBJ": "mapscript.MS_ON"}, 
                    "setProjection": {"TEMP":"\"init=epsg:{{epsg_id}}\""},
                    "type": {"OBJ": "mapscript.MS_LAYER_POLYGON"}, 
                    "units": {"OBJ": "mapscript.MS_METERS"},
                    "tileitem": "location",
                    "connectiontype": {"OBJ": "mapscript.MS_POSTGIS"},
                    "connection": {"VAR": "db_connection"},
                    "data": {"TEMP": "\"{{layer_var['data']}}\""},
                    "setProcessing":[
                            "LABEL_NO_CLIP=ON", 
                            "CLOSE_CONNECTION=DEFER"
                        ], 
                    "metadata.set": [
                        [
                            "wms_abstract",
                            {"TEMP": "\"{{layer_var['wms_abstract']}}\""}
                        ]
                    ],
                    "labelitem": "name",
                    "SUB_OBJ":[
                        {
                            "OBJ": "mapscript.classObj",
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(200,200,200) }}"
                                    },
                                    "opacity": 50
                                }
                            ],
                            "addLabel": {
                                "11-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_polygon"
                                    }
                                }
                            }
                        }
                    ]
                }
            }
        ],
        "waterareas":[
            { "TEMP": "{% import 'macros' as macros %}"},
            {    
                "4-20":{
                    "OBJ": "mapscript.layerObj",
                    "name": {"TEMP": "\"{{layer_var['name']}}\""},
                    "group": {"TEMP": "\"{{layer_var['name']}}\""},
                    "status": {"OBJ": "mapscript.MS_ON"}, 
                    "setProjection": {"TEMP":"\"init=epsg:{{epsg_id}}\""},
                    "type": {"OBJ": "mapscript.MS_LAYER_POLYGON"}, 
                    "units": {"OBJ": "mapscript.MS_METERS"},
                    "tileitem": "location",
                    "connectiontype": {"OBJ": "mapscript.MS_POSTGIS"},
                    "connection": {"VAR": "db_connection"},
                    "data": {"TEMP": "\"{{layer_var['data']}}\""},
                    "setProcessing":[
                            "LABEL_NO_CLIP=ON", 
                            "CLOSE_CONNECTION=DEFER"
                        ], 
                    "metadata.set": [
                        [
                            "wms_abstract",
                            {"TEMP": "\"{{layer_var['wms_abstract']}}\""}
                        ]
                    ],
                    "classitem": "type",
                    "labelitem": "name",
                    "SUB_OBJ":[
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["riverbank"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(153,179,204) }}"
                                    },
                                    "outlinecolor": {
                                        "TEMP": "{{ macros.color_hex('#b3c6d4') }}"
                                    },
                                    "outlinewidth": 0
                                }
                            ]
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["water"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(153,179,204) }}"
                                    },
                                    "outlinecolor": {
                                        "TEMP": "{{ macros.color_hex('#e3ded4') }}"
                                    },
                                    "outlinewidth": 0
                                }
                            ],
                            "addLabel": {
                                "15-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_polygon",
                                        "color":{
                                            "TEMP": "{{ macros.color_hex('#6b94b0') }}"
                                        }
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(153,179,204) }}"
                                    },
                                    "outlinecolor": {
                                        "TEMP": "{{ macros.color_hex('#e3ded4') }}"
                                    },
                                    "outlinewidth": 0
                                }
                            ],
                            "addLabel": {
                                "6-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_polygon",
                                        "color":{
                                            "TEMP": "{{ macros.color_hex('#6b94b0') }}"
                                        }
                                    }
                                }
                            }
                        }
                    ]
                }
            }
        ],
        "waterways":[
            { "TEMP": "{% import 'macros' as macros %}"},
            {    
                "6-20":{
                    "OBJ": "mapscript.layerObj",
                    "name": {"TEMP": "\"{{layer_var['name']}}\""},
                    "group": {"TEMP": "\"{{layer_var['name']}}\""},
                    "status": {"OBJ": "mapscript.MS_ON"}, 
                    "setProjection": {"TEMP":"\"init=epsg:{{epsg_id}}\""},
                    "type": {"OBJ": "mapscript.MS_LAYER_LINE"}, 
                    "units": {"OBJ": "mapscript.MS_METERS"},
                    "tileitem": "location",
                    "connectiontype": {"OBJ": "mapscript.MS_POSTGIS"},
                    "connection": {"VAR": "db_connection"},
                    "data": {"TEMP": "\"{{layer_var['data']}}\""},
                    "setProcessing":[
                            "LABEL_NO_CLIP=ON", 
                            "CLOSE_CONNECTION=DEFER"
                        ], 
                    "metadata.set": [
                        [
                            "wms_abstract",
                            {"TEMP": "\"{{layer_var['wms_abstract']}}\""}
                        ]
                    ],
                    "classitem": "type",
                    "labelitem": "name",
                    "SUB_OBJ":[
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["river"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(153,179,204) }}"
                                    },
                                    "width": [
                                        {"6-6": 0.15},
                                        {"7-7": 0.25},
                                        {"8-8": 0.5},
                                        {"9-10": 1},
                                        {"11-12": 2},
                                        {"13-14": 3},
                                        {"15-15": 4},
                                        {"16-16": 5},
                                        {"17-17": 6},
                                        {"18-20": 7}
                                    ]
                                }
                            ],
                            "addLabel": {
                                "6-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_line",
                                        "size": [
                                            {"6-14": 8},
                                            {"15-16": 9},
                                            {"17-20": 10}
                                        ],
                                        "color":{
                                            "TEMP": "{{ macros.color_hex('#6b94b0') }}"
                                        },
                                        "priority": 3
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["stream"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(153,179,204) }}"
                                    },
                                    "width": [
                                        {"6-9": 0},
                                        {"10-11": 0.5},
                                        {"12-13": 1},
                                        {"14-20": 2}
                                    ]
                                }
                            ],
                            "addLabel": {
                                "15-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_line",
                                        "size":8,
                                        "color":{
                                            "TEMP": "{{ macros.color_hex('#6b94b0') }}"
                                        }
                                    }
                                }
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["canal"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_rgb(153,179,204) }}"
                                    },
                                    "width": [
                                        {"6-9": 0},
                                        {"10-11": 0.5},
                                        {"12-13": 1},
                                        {"14-14": 2},
                                        {"15-15": 4},
                                        {"16-16": 8},
                                        {"17-17": 16},
                                        {"18-18": 30},
                                        {"19-19": 60},
                                        {"20-20": 120}
                                    ]
                                }
                            ],
                            "addLabel": {
                                "14-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_line",
                                        "size":8,
                                        "partials": {"OBJ": "mapscript.MS_FALSE"},
                                        "color":{
                                            "TEMP": "{{ macros.color_hex('#6b94b0') }}"
                                        }
                                    }
                                }
                            }
                        }
                    ]
                }
            }
        ],
        "railways":[
            { "TEMP": "{% import 'macros' as macros %}"},
            {    
                "8-20":{
                    "OBJ": "mapscript.layerObj",
                    "name": {"TEMP": "\"{{layer_var['name']}}\""},
                    "group": {"TEMP": "\"{{layer_var['name']}}\""},
                    "status": {"OBJ": "mapscript.MS_ON"}, 
                    "setProjection": {"TEMP":"\"init=epsg:{{epsg_id}}\""},
                    "type": {"OBJ": "mapscript.MS_LAYER_LINE"}, 
                    "units": {"OBJ": "mapscript.MS_METERS"},
                    "tileitem": "location",
                    "connectiontype": {"OBJ": "mapscript.MS_POSTGIS"},
                    "connection": {"VAR": "db_connection"},
                    "data": {"TEMP": "\"{{layer_var['data']}}\""},
                    "setProcessing":[
                            "LABEL_NO_CLIP=ON", 
                            "CLOSE_CONNECTION=DEFER"
                        ], 
                    "metadata.set": [
                        [
                            "wms_abstract",
                            {"TEMP": "\"{{layer_var['wms_abstract']}}\""}
                        ]
                    ],
                    "classitem": "type",
                    "labelitem": "name",
                    "SUB_OBJ":[
                        {
                            "15-20":{
                                "OBJ": "mapscript.classObj",
                                "setExpression": ["subway"],
                                "SUB_OBJ": [
                                    {
                                        "OBJ": "mapscript.styleObj",
                                        "width": [
                                            {"15-18": 0.5},
                                            {"19-20": 1}
                                        ],
                                        "color": {
                                            "TEMP": "{{ macros.color_hex('#777777') }}"
                                        },
                                        "outlinewidth": 0,
                                        "outlinecolor": {
                                            "TEMP": "{{ macros.color_hex('#777777') }}"
                                        },
                                        "pattern":[
                                            [2, 5]
                                        ],
                                        "linecap": {"OBJ": "mapscript.MS_CJC_BUTT"}
                                    }
                                ]
                            }
                        },
                        {
                            "OBJ": "mapscript.classObj",
                            "setExpression": ["{rail,light_rail,narrow_gauge,preserved,funicular,monorail}"],
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "width": [
                                        {"8-10": 0.5},
                                        {"11-20": 1}
                                    ],
                                    "color": {
                                        "TEMP": "{{ macros.color_hex('#777777') }}"
                                    },
                                    "pattern":[
                                        [2, 2, 0]
                                    ],
                                    "opacity": 40,
                                    "linecap": {"OBJ": "mapscript.MS_CJC_BUTT"}
                                }
                            ]
                        }
                    ]
                }
            }
        ],
        "buildings":[
            { "TEMP": "{% import 'macros' as macros %}"},
            {    
                "15-20":{
                    "OBJ": "mapscript.layerObj",
                    "name": {"TEMP": "\"{{layer_var['name']}}\""},
                    "group": {"TEMP": "\"{{layer_var['name']}}\""},
                    "status": {"OBJ": "mapscript.MS_ON"}, 
                    "setProjection": {"TEMP":"\"init=epsg:{{epsg_id}}\""},
                    "type": {"OBJ": "mapscript.MS_LAYER_POLYGON"}, 
                    "units": {"OBJ": "mapscript.MS_METERS"},
                    "tileitem": "location",
                    "connectiontype": {"OBJ": "mapscript.MS_POSTGIS"},
                    "connection": {"VAR": "db_connection"},
                    "data": {"TEMP": "\"{{layer_var['data']}}\""},
                    "setProcessing":[
                            "LABEL_NO_CLIP=ON", 
                            "CLOSE_CONNECTION=DEFER"
                        ], 
                    "metadata.set": [
                        [
                            "wms_abstract",
                            {"TEMP": "\"{{layer_var['wms_abstract']}}\""}
                        ]
                    ],
                    "labelitem": "name",
                    "SUB_OBJ":[
                        {
                            "OBJ": "mapscript.classObj",
                            "SUB_OBJ": [
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "color": {
                                        "TEMP": "{{ macros.color_hex('#bbbbbb') }}"
                                    },
                                    "opacity": 50
                                },
                                {
                                    "OBJ": "mapscript.styleObj",
                                    "outlinecolor": {
                                        "TEMP": "{{ macros.color_hex('#333333') }}"
                                    },
                                    "width": [
                                         {"15-16": 0},
                                         {"17-20": 0.5}
                                    ]
                                }
                            ],
                            "addLabel": {
                                "17-20": {
                                    "SUB_OBJ": {
                                        "VAR": "label_polygon",
                                        "size": 7
                                    }
                                }
                            }
                        }
                    ]
                }
            }
        ],
        "map_temp":{
            "SCALES": {"VAR": "up_scale"},
            "OBJ": "mapscript.mapObj",
            "name": {"VAR": "name"},
            "setFontSet":["maps/fonts/fonts.lst"],
            "imagecolor.setRGB": [{"TEMP": "{{imagecolor}}"}],
            "setExtent": [{"VAR": "extent"}],
            "setProjection": {"TEMP":"'init=epsg:{{epsg_id}}'"},
            "setSize": [{"VAR": "size"}],
            "units": {
                "OBJ": "mapscript.MS_DD"
            },
            "web.metadata.set": [
                ["ows_enable_request", "*"],
                ["labelcache_map_edge_buffer", "-10"],
                ["wms_srs", {"VAR": "wms_srs"}],
                ["wms_title", {"VAR": "wms_title"}],
                ["wms_enable_request", "*"]
            ],
            "SUB_OBJ": [
                {"TEMP": [
                        "{% for layer_var in layer_dicts %}",
                        "    {% include layer_var['layer_temp'] %},",
                        "{% endfor %}"
                    ]
                }
            ]
        }
    },
    "MAP":{
        "TEMP":"map_temp"
    }
}